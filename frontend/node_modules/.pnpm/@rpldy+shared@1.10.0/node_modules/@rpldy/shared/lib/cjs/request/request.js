"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _XhrPromise = _interopRequireDefault(require("./XhrPromise"));
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
const setHeaders = (req, headers) => {
  if (headers) {
    Object.keys(headers).forEach(name => {
      if (headers[name] !== undefined) {
        req.setRequestHeader(name, headers[name]);
      }
    });
  }
};
const request = (url, data, options = {}) => {
  const req = new XMLHttpRequest();
  return new _XhrPromise.default((resolve, reject) => {
    req.onerror = () => reject(req);
    req.ontimeout = () => reject(req);
    req.onabort = () => reject(req);
    req.onload = () => resolve(req);
    req.open(options?.method || "GET", url);
    setHeaders(req, options?.headers);
    req.withCredentials = !!options?.withCredentials;
    options?.preSend?.(req);
    req.send(data);
  }, req);
};
var _default = exports.default = request;